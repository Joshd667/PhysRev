<!-- Custom Modal Dialog -->
<div x-show="showCustomModal"
     x-cloak
     role="dialog"
     aria-modal="true"
     aria-labelledby="modal-title"
     aria-describedby="modal-description"
     class="fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"
     @click.self="cancelModal()"
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-150"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0">

    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-md w-full overflow-hidden"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0 scale-95"
         x-transition:enter-end="opacity-100 scale-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100 scale-100"
         x-transition:leave-end="opacity-0 scale-95"
         @click.stop>

        <!-- Modal Header -->
        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center space-x-3">
                <!-- Icon based on modal type -->
                <div class="flex-shrink-0">
                    <template x-if="modalType === 'alert'">
                        <div class="w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center">
                            <i data-lucide="info" class="w-5 h-5 text-blue-600 dark:text-blue-400"></i>
                        </div>
                    </template>
                    <template x-if="modalType === 'confirm'">
                        <div class="w-10 h-10 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center">
                            <i data-lucide="alert-triangle" class="w-5 h-5 text-amber-600 dark:text-amber-400"></i>
                        </div>
                    </template>
                    <template x-if="modalType === 'prompt'">
                        <div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center">
                            <i data-lucide="message-circle" class="w-5 h-5 text-green-600 dark:text-green-400"></i>
                        </div>
                    </template>
                </div>
                <h3 id="modal-title" class="text-lg font-bold text-gray-900 dark:text-white" x-text="modalTitle"></h3>
            </div>
        </div>

        <!-- Modal Body -->
        <div class="px-6 py-4">
            <p id="modal-description" class="text-gray-700 dark:text-gray-300 text-sm leading-relaxed" x-text="modalMessage"></p>

            <!-- Input field for prompt -->
            <template x-if="modalType === 'prompt'">
                <input type="text"
                       x-model="modalInputValue"
                       @keydown.enter="confirmModal()"
                       @keydown.escape="cancelModal()"
                       x-init="$nextTick(() => $el.focus())"
                       aria-label="Enter value for prompt"
                       class="mt-4 w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors"
                       placeholder="Enter value...">
            </template>
        </div>

        <!-- Modal Footer -->
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-3">
            <!-- Cancel button (for confirm and prompt) -->
            <template x-if="modalType !== 'alert'">
                <button @click="cancelModal()"
                        aria-label="Cancel and close dialog"
                        class="px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">
                    Cancel
                </button>
            </template>

            <!-- Confirm/OK button -->
            <button @click="confirmModal()"
                    :class="modalType === 'confirm' ? 'bg-amber-600 hover:bg-amber-700' : 'bg-blue-600 hover:bg-blue-700'"
                    :aria-label="modalType === 'alert' ? 'Acknowledge and close dialog' : 'Confirm action'"
                    class="px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors shadow-sm">
                <span x-text="modalType === 'alert' ? 'OK' : 'Confirm'"></span>
            </button>
        </div>
    </div>
</div>
